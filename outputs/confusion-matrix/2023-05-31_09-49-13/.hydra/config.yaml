epochs: 40
datamodule:
  _target_: data.datamodule.DataModule
  train_dataset_path: ${dataset.train_path}
  train_transform: ${dataset.train_transform}
  val_transform: ${dataset.test_transform}
  aug_transform: ${dataset.aug_transform}
  batch_size: ${dataset.batch_size}
  num_workers: ${dataset.num_workers}
data_dir: ${root_dir}/dataset
root_dir: ${hydra:runtime.cwd}
checkpoint_path: ${root_dir}/checkpoints/model.pt
model:
  _target_: models.resnet.ResNetFinetune
  num_classes: ${dataset.num_classes}
  frozen: true
dataset:
  train_transform:
    _target_: torchvision.transforms.Compose
    transforms:
    - _target_: torchvision.transforms.Resize
      size:
      - 224
      - 224
    - _target_: torchvision.transforms.ToTensor
    - _target_: torchvision.transforms.Normalize
      mean:
      - 0.485
      - 0.456
      - 0.406
      std:
      - 0.229
      - 0.224
      - 0.225
  test_transform:
    _target_: torchvision.transforms.Compose
    transforms:
    - _target_: torchvision.transforms.Resize
      size:
      - 224
      - 224
    - _target_: torchvision.transforms.ToTensor
    - _target_: torchvision.transforms.Normalize
      mean:
      - 0.485
      - 0.456
      - 0.406
      std:
      - 0.229
      - 0.224
      - 0.225
  aug_transform:
    _target_: torchvision.transforms.Compose
    transforms:
    - _target_: torchvision.transforms.RandomHorizontalFlip
    - _target_: torchvision.transforms.RandomVerticalFlip
    - _target_: torchvision.transforms.RandomRotation
      degrees: 10
    - _target_: torchvision.transforms.ColorJitter
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
    - _target_: torchvision.transforms.Normalize
      mean:
      - 0.485
      - 0.456
      - 0.406
      std:
      - 0.229
      - 0.224
      - 0.225
  num_classes: 48
  batch_size: 128
  num_workers: 8
  train_path: ${data_dir}/train
  test_path: ${data_dir}/test
optim:
  _target_: torch.optim.AdamW
  lr: 0.001
  betas:
  - 0.9
  - 0.999
loss_fn:
  _partial_: true
  _target_: torch.nn.functional.cross_entropy
  reduction: mean
  label_smoothing: 0.05
